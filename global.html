<script>
// Set up the Listener
safari.application.addEventListener("command", performCommand, false);
 
// Function to perform when event is received
function performCommand(event) {
    // Make sure event comes from the button
    if (event.command == "mendeley") {
        safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("mendeley", "");
    }
}
</script>
